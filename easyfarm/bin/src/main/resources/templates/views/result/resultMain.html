<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">

	<th:block layout:fragment="customTitle">
		<title>실행 메인</title>
	</th:block>
	
	<th:block layout:fragment="pageTitle">
		프로젝트별 수입/지출 (결과)
	</th:block>
	
	<!-- 사용자 정의 css 라이브러리 -->
	<th:block layout:fragment="customCssLib">
		
		
	</th:block>
	
	<!-- 사용자 정의 css -->
	<th:block layout:fragment="customCss">
	</th:block>
	
	<th:block layout:fragment="customContents">
	
	<div class="row small-spacing">
			<div class="col-xs-12">
				<div class="box-content" style="overflow: auto;">
					
					
					
					
					
					
					<div class="bs-example bs-example-tabs" role="tabpanel" data-example-id="togglable-tabs" style="overflow: auto;">
					<h1>
						<a th:href="@{/resultData}"> :: 내 프로젝트 데이터 보기 :: </a>
					</h1>
					<a th:href="@{/result}"> :: 데이터 끄기 :: </a>
					<a th:href="@{/resultCalendar}"> :: 캘린더 :: </a>
					    <ul id="myTab" class="nav nav-tabs" role="tablist">
					      <li role="presentation" class=""><a href="#home" id="home-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="false">실행 종합</a></li>
					      <li role="presentation" class="dropdown active">
					        <a href="#" id="myTabDrop1" class="dropdown-toggle" data-toggle="dropdown" aria-controls="myTabDrop1-contents" aria-expanded="false"> 지출항목별 상세정보 <span class="caret"></span></a>
					        <ul class="dropdown-menu" role="menu" aria-labelledby="myTabDrop1" id="myTabDrop1-contents">
					          <li><a href="#dropdown1" tabindex="-1" role="tab" id="dropdown1-tab" data-toggle="tab" aria-controls="dropdown1">인건비</a></li>
					          <li><a href="#dropdown2" tabindex="-1" role="tab" id="dropdown2-tab" data-toggle="tab" aria-controls="dropdown2">공과금</a></li>
					          <li><a href="#dropdown3" tabindex="-1" role="tab" id="dropdown3-tab" data-toggle="tab" aria-controls="dropdown3">기타비용</a></li>
					          <li><a href="#dropdown4" tabindex="-1" role="tab" id="dropdown4-tab" data-toggle="tab" aria-controls="dropdown4">구매비</a></li>
					          <li><a href="#dropdown5" tabindex="-1" role="tab" id="dropdown5-tab" data-toggle="tab" aria-controls="dropdown5">농기계대여</a></li>
					          <li><a href="#dropdown6" tabindex="-1" role="tab" id="dropdown6-tab" data-toggle="tab" aria-controls="dropdown6">농기계유지비</a></li>
					          <li><a href="#dropdown7" tabindex="-1" role="tab" id="dropdown7-tab" data-toggle="tab" aria-controls="dropdown7">수확물 판매</a></li>
					        </ul>
					      </li>
					    </ul>
					    <div id="myTabContent" class="tab-content" style="overflow: auto;">
					      <div role="tabpanel" class="tab-pane fade " id="home" aria-labelledby="home-tab">
								
								
								<div class="col-xs-12 box-content " style="border: none; overflow: auto; ">
									<h2>프로젝트 수입/지출</h2>
									<div class="pull-right"  th:each="i : ${insurancePayResult}">
										프로젝트 코드 : <i th:text="${i.insurancePayPlan.projectCode}"></i>	<br/>
										<br/> 
									</div>
									<table id="top-table" class="table table-striped table-bordered display" style="width: 100%" border="1" >
										<thead>
											<tr>
												<th style="text-align: center;"></th>
												<th style="text-align: center;"></th>
												<th style="text-align: center;"></th>
												<th style="text-align: center;"></th>
												<th style="text-align: center;"></th>
												<th style="text-align: center;"></th>
											</tr>
										</thead>
										<tbody>	
										
										
											<tr>
												<td style="border: none;">보험료</td>
												<td style="border: none;">계획/실행</td>
												<td style="border: none;">보험명</td>
												<td style="border: none;">총보험비</td>
												<td style="border: none;">보장내용</td>
												<td style="border: none;"></td>
											</tr>
											<tr th:each="i : ${insurancePayResult}">
												<td>보험료</td>
												<td>계획</td>
												<td th:text="${i.insurancePayPlan.insureName}"></td>
												<td th:text="${i.insurancePayPlan.insurePayTotal}"></td>
												<td th:text="${i.insurancePayPlan.insureDatail}"></td>
												<td></td>
											</tr>
											<tr th:each="i : ${insurancePayResult}">
												<td>보험료</td>
												<td>실행</td>
												<td th:text="${i.insureName}"></td>
												<td th:text="${i.insurePayTotal}"></td>
												<td th:text="${i.insureDatail}"></td>
												<td></td>
											</tr>
											
											
											
											<tr>
												<td style="border: none;">공과금</td>
												<td style="border: none;">계획/결과</td>
												<td style="border: none;">해당월</td>
												<td style="border: none;">공과금명</td>
												<td style="border: none;">납부금액</td>
												<td style="border: none;">납부완료여부</td>
											</tr>
											<tr th:each="t : ${taxPayResult}">
												<td>공과금</td>
												<td>계획</td>
												<td th:text="${t.taxPayPlan.taxPayWhatmonth}"></td>
												<td th:text="${t.taxPayPlan.taxPayDetail}"></td>
												<td th:text="${t.taxPayPlan.taxPay}"></td>
												<td></td>
											</tr>
											<tr th:each="t : ${taxPayResult}">
												<td>공과금</td>
												<td>결과</td>
												<td th:text="${t.taxPayRunCorrMonth}"></td>
												<td th:text="${t.taxPayRunMemo}"></td>
												<td th:text="${t.taxPayRunPay}"></td>
												<td th:text="${t.completeStatus}"></td>
											</tr>
										</tbody> 	
									</table>
								</div>
								
								
								
								<!-- 단계별 비용계산 테이블 -->
								
								
											<div class="col-xs-12 box-content">
												<h2>지출항목별 비용</h2>
												<div class="pull-right">
													비용결과 합계 : <i class="paytotal"></i>	<br/>
													<br/>
												</div>
												<table id="example-row-grouping-2" class="table table-striped table-bordered display" style="width:100%">
													<thead>
														<tr>
															<th style="text-align: center;">지출항목명</th>
															<th style="text-align: center;"> 계획 / 실행 </th>
															<th style="text-align: center;"> 항목명 </th>
															<th style="text-align: center;"> 금액 </th>
															<th style="text-align: center;"> 날짜</th>
															<th style="text-align: center;"> 결과마감여부</th>
														</tr>
													</thead>
													<tbody>
														<tr th:each="e : ${etcpayResult}">
															<td>기타비용 <i class="pull-right etctotal"></i></td>
															<td>계획</td>
															<td th:text="${e.etcPayPlan.etcPayDetail}"></td>
															<td th:text="${e.etcPayPlan.etcPay}"></td>
															<td th:text="${e.etcPayPlan.etcPayDate}"></td>
															<td></td>
														</tr>
														<tr th:each="e : ${etcpayResult}">
															<td>기타비용 <i class="pull-right etctotal"></i></td>
															<td>실행</td>
															<td th:text="${e.etcPayRunMemo}"></td>
															<td th:text="${e.etcPayRunPay}" class="etcpay"></td>
															<td th:text="${e.etcPayRunDate}"></td>
															<td th:text="${e.completeStatus}"></td>
														</tr>
														
														<tr th:each="r : ${resourcePayResult}">
															<td>농자재 매입<i class="pull-right resourcetotal"></i></td>
															<td>계획</td>
															<td th:text="${r.resourcePayPlan.stockItemCode}"></td>
															<td th:text="${r.resourcePayPlan.stockItemTotalPay}"></td>
															<td th:text="${r.resourcePayPlan.stockItemIncomeDate}"></td>
															<td></td>
														</tr>
														<tr th:each="r : ${resourcePayResult}">
															<td>농자재 매입<i class="pull-right resourcetotal"></i></td>
															<td>실행</td>
															<td th:text="${r.stockItemCode}"></td>
															<td th:text="${r.stockItemTotalPay}" class="resourcepay"></td>
															<td th:text="${r.stockItemIncomeDate}"></td>
															<td th:text="${r.completeStatus}"></td>
														</tr>
														
														<tr th:each="m : ${machineLeasePayResult}">
															<td>농기계 대여료<i class="pull-right machineleasetotal"></i></td>
															<td>계획</td>
															<td th:text="${m.machineLeasePayPlan.farmBookmarkMachineCode}"></td>
															<td th:text="${m.machineLeasePayPlan.machineLeasePayTotal}"></td>
															<td th:text="${m.machineLeasePayPlan.machineLeaseHowlong}"></td>
															<td></td>
														</tr>
														<tr th:each="m : ${machineLeasePayResult}">
															<td>농기계 대여료<i class="pull-right machineleasetotal"></i></td>
															<td>실행</td>
															<td th:text="${m.farmBookmarkMachineCode}"></td>
															<td th:text="${m.machineLeaseRunPay}" class="machineLeasePay"></td>
															<td th:text="${m.machineLeaseRunDate}"></td>
															<td th:text="${m.completeStatus}"></td>
														</tr>
														
														<!-- 
														
														<tr th:each="u : ${machineUsePayResult}">
															<td>보유한 농기계 사용</td>
															<td>계획</td>
															<td th:text="${u.machineUsePayPlan.farmRetainMachineCode}"></td>
															<td></td>
															<td></td>
															<td></td>
														</tr>
														<tr th:each="u : ${machineUsePayResult}">
															<td>보유한 농기계 사용</td>
															<td>실행</td>
															<td th:text="${u.farmRetainMachineCode}"></td>
															<td ></td>
															<td th:text="${u.machineUseRunDate}"></td>
															<td th:text="${u.completeStatus}"></td>
														</tr>
														
														 -->
														
														<tr th:each="w : ${workForcePayResult}">
															<td>인건비<i class="pull-right humantotal"></i></td>
															<td>계획</td>
															<td th:text="${w.workforcePayPlan.planWorkphaseCateCode}"></td>
															<td th:text="${w.workforcePayPlan.workforceCount}"></td>
															<td th:text="${w.workforcePayPlan.workforcePayTotal}"></td>
															<td></td>
														</tr>
														<tr th:each="w : ${workForcePayResult}">
															<td>인건비<i class="pull-right humantotal"></i></td>
															<td>실행</td>
															<td th:text="${w.workforcePayCode}"></td>
															<td th:text="${w.workforceRunQuantity}"></td>
															<td th:text="${w.workforcePayRunTotal}" class="humanpay"></td>
															<td th:text="${w.workforceRunDate}"></td>
														</tr>
													</tbody>
												</table>
											</div>
								    
										
										<!-- <div class="col-xs-6">
											productGainRun
											<table border="1">
												<thead>
													<tr>
														<th style="text-align: center;">productGainRun code</th>
														<th style="text-align: center;">상품명</th>
														<th style="text-align: center;">가격</th>
														<th style="text-align: center;">판매자 아이디</th>
														<th style="text-align: center;">상품 등록일</th>
														<th style="text-align: center;">수정</th>
														<th style="text-align: center;">삭제</th>
													</tr>
												</thead>
												<tbody>
													<tr th:each="u : ${productGainResult}">
														<td th:text="${u.productGainRunCode}"></td>
													</tr>
												</tbody> 	
											</table>
										</div>
										<div class="col-xs-6">
											resourceUsePlanRun
											<table border="1">
												<thead>
													<tr>
														<th style="text-align: center;">resourceUsePlanRun code</th>
														<th style="text-align: center;">상품명</th>
														<th style="text-align: center;">가격</th>
														<th style="text-align: center;">판매자 아이디</th>
														<th style="text-align: center;">상품 등록일</th>
														<th style="text-align: center;">수정</th>
														<th style="text-align: center;">삭제</th>
													</tr>
												</thead>
												<tbody>
													<tr th:each="p : ${resourceUsePlanResult}">
														<td th:text="${p.resourceUseplanRunCode}"></td>
													</tr>
												</tbody> 	
											</table>
										</div> -->
					      </div>
					    
					      <div role="tabpanel" class="tab-pane fade  active in" id="dropdown1" aria-labelledby="dropdown1-tab">
							<div class="col-xs-12 box-content " style="border: none; overflow: auto; ">
								<div th:each="w : ${workForcePayResult}">
									<h2>인건비 실행결과</h2>
									<div class="pull-right">
										인건비 실행코드 : <i th:text="${w.workforcePayRunCode}"></i>	<br/>
										인건비 계획코드 : <i th:text="${w.workforcePayPlan.workforcePayCode}"></i>	<br/>
										근무일자 : <i th:text="${w.workforceRunDate}"></i>	<br/>
										실제인건비 합계 : <i class="total"></i><br/>
										<br/>
									</div>
									<table id="example" class="table table-striped table-bordered display" style="width: 100%" border="1" >
										<thead style="">
											<tr>
												<th style="text-align: center;"> 계획 </th>
												<th style="text-align: center;"> 근무인원 </th>
												<th style="text-align: center;"> 근무일수 </th>
												<th style="text-align: center;"> 일일인건비 </th>
												<th style="text-align: center;"> 예상 인건비합계 </th>
												<th style="text-align: center;"> 작성자아이디 </th>
												<th style="text-align: center;">  </th>
											</tr>
										</thead>
										<tbody>
											<tr style="text-align: center;">
												<td>계획</td>
												<td th:text="${w.workforcePayPlan.workforceCount}"></td>
												<td th:text="${w.workforcePayPlan.workforceHowlong}"></td>
												<td th:text="${w.workforcePayPlan.workforcePayDay}" ></td>
												<td th:text="${w.workforcePayPlan.workforcePayTotal}" style=" background: #F5F6CE;"></td>
												<td th:text="${w.workforcePayPlan.regMemberId}"></td>
												<td></td>
											</tr>
											<tr style="text-align: center; font-weight: bold;">
												<td> 실행 </td>
												<td> 근무인원 </td>
												<td> 근무일 </td>
												<td> 일일인건비 </td>
												<td> 실제 인건비합계 </td>
												<td> 작성자아이디 </td>
												<td> 결과마감여부 </td>
											</tr>
											<tr style="text-align: center;">
												<td>실행</td>
												<td th:text="${w.workforceRunQuantity}"></td>
												<td th:text="${w.workforceRunDate}"></td>
												<td th:text="${w.workforcePayRunDay}"></td>
												<td th:text="${w.workforcePayRunTotal}" style=" background: #F5F6CE;"></td>
												<td th:text="${w.regMemberId}"></td>
												<td th:text="${w.completeStatus}"></td>
											</tr>
										</tbody> 	
									</table>
								</div>
							</div>
					      </div>
					      <div role="tabpanel" class="tab-pane fade" id="dropdown2" aria-labelledby="dropdown2-tab">
					      	<div class="col-xs-12 box-content " style="border: none; overflow: auto;">
								<div th:each="t : ${taxPayResult}">
									<h2>공과금 실행결과</h2>
									<div class="pull-right">
										공과금 실행코드 : <i th:text="${t.taxPayRunCode}"></i>	<br/>
										공과금 계획코드 : <i th:text="${t.taxPayPlan.taxPayCode}"></i>	<br/>
										해당월 : <i th:text="${t.taxPayRunCorrMonth}"></i>	<br/>
										공과금 합계 : <i class="total"></i><br/>
										<br/>
									</div>
									<table id="example2" class="table table-striped table-bordered display" style="width: 100%" border="1" >
										<thead>
											<tr>
												<th style="text-align: center;"> 계획 </th>
												<th style="text-align: center;"> 공과금항목 </th>
												<th style="text-align: center;"> 공과금명 </th>
												<th style="text-align: center;"> 납부금액 </th>
												<th style="text-align: center;"> 해당 월 </th>
												<th style="text-align: center;"> 작성자아이디 </th>
												<th style="text-align: center;"> 작성일 </th>
												<th style="text-align: center;"> 납부대상 </th>
											</tr>
										</thead>
										<tbody>
											<tr style="text-align: center;">
												<td>계획</td>
												<td th:text="${t.taxPayPlan.taxPayCateCode}"></td>
												<td th:text="${t.taxPayPlan.taxPayDetail}"></td>
												<td th:text="${t.taxPayPlan.taxPay}"></td>
												<td th:text="${t.taxPayPlan.taxPayWhatmonth}"></td>
												<td th:text="${t.taxPayPlan.regMemberId}"></td>
												<td th:text="${t.taxPayPlan.regDate}"></td>
												<td th:text="${t.taxPayPlan.clientCode}"></td>
											</tr>
											<tr style="text-align: center; font-weight: bold;">
												<td> 실행 </td>
												<td> 공과금항목 </td>
												<td> 공과금명 </td>
												<td> 납부금액 </td>
												<td> 해당 월 </td>
												<td> 작성자아이디 </td>
												<td> 작성일 </td>
												<td> 납부대상 </td>
											</tr>
											<tr style="text-align: center;">
												<td>실행</td>
												<td th:text="${t.taxPayCateCode}"></td>
												<td th:text="${t.taxPayRunMemo}"></td>
												<td th:text="${t.taxPayRunPay}"></td>
												<td th:text="${t.taxPayRunCorrMonth}"></td>
												<td th:text="${t.regMemberId}"></td>
												<td th:text="${t.regDate}"></td>
												<td th:text="${t.clientCode}"></td>
											</tr>
										</tbody> 	
									</table>
								</div>
							</div>
					      </div>
					      <div role="tabpanel" class="tab-pane fade" id="dropdown3" aria-labelledby="dropdown3-tab">
					      		<div class="col-xs-12 box-content " style="border: none; overflow: auto; ">
									<div th:each="e : ${etcpayResult}">
										<h2>기타비용 실행결과</h2>
										<div class="pull-right">
											기타비용 실행코드 : <i th:text="${e.etcPayRunCode}"></i>	<br/>
											기타비용 계획코드 : <i th:text="${e.etcPayPlan.etcPayCode}"></i>	<br/>
											지불일자 : <i th:text="${e.etcPayRunDate}"></i>	<br/>
											실제기타비용 합계 : <i class="total"></i><br/>
											<br/>
										</div>
										<table id="example3" class="table table-striped table-bordered display" style="width: 100%" border="1" >
											<thead >
												<tr>
													<th style="text-align: center;">기타비용 집행명</th>
													<th style="text-align: center;">계획 기타비용 금액</th>
													<th style="text-align: center;">실행결과 기타비용 금액</th>
												</tr>
											</thead>
											<tbody>
												<tr style="padding: 20px">
													<td th:text="${e.etcPayRunMemo}" style="padding: 20px"></td>
													<td th:text="${e.etcPayPlan.etcPay}" style="padding: 20px"></td>
													<td th:text="${e.etcPayRunPay}" style="padding: 20px"></td>
												</tr>
											</tbody> 	
										</table>
									</div>
								</div>
					      </div>
					      <div role="tabpanel" class="tab-pane fade" id="dropdown4" aria-labelledby="dropdown4-tab">
					      	<p>44444</p>
					      </div>
					      <div role="tabpanel" class="tab-pane fade" id="dropdown5" aria-labelledby="dropdown5-tab">
					      	<p>55555</p>
					      </div>
					      <div role="tabpanel" class="tab-pane fade" id="dropdown6" aria-labelledby="dropdown6-tab">
					      	<p>66666</p>
					      </div>
					      <div role="tabpanel" class="tab-pane fade" id="dropdown7" aria-labelledby="dropdown7-tab">
					      	<p>77777</p>
					      </div>
					    </div>
					</div>
				</div>	
			</div>
		</div>

	
	
	</th:block>	
	
	
	
	<!-- 사용자 정의 자바스크립트 -->
	<th:block layout:fragment="customJavaScript">
	
		<script type="text/javascript">
			$(function(){
				var etcpay = $(".etcpay"); 
				var machineLeasePay = $(".machineLeasePay"); 
				var humanpay = $(".humanpay"); 
				var resourcepay = $(".resourcepay"); 
				console.log(etcpay);
				var etcSum = 0;
				var machineLeaseSum = 0;
				var humanSum = 0;
				var resourceSum = 0;
				var i = 0;
				while(i < 10){
					
					etcSum += Number(etcpay.eq(i).text());
					machineLeaseSum += Number(machineLeasePay.eq(i).text());
					humanSum += Number(humanpay.eq(i).text());
					resourceSum += Number(resourcepay.eq(i).text());
					
					i++;
				};
				console.log(etcSum);
				$('.etctotal').text("비용 : "+etcSum);
				$('.machineleasetotal').text("비용 : "+machineLeaseSum);
				$('.humantotal').text("비용 : "+humanSum);
				$('.resourcetotal').text("비용 : "+resourceSum);
				$('.paytotal').text(resourceSum+humanSum+machineLeaseSum+etcSum);
			})
			
			$('#example2, #example3').DataTable();
			
			
			var groupNum = 0;
			var table = $('#example-row-grouping-2, #top-table').DataTable({
				"columnDefs": [
					{ "visible": false, "targets": groupNum }
				],
				"order": [ groupNum, 'asc' ],
				"displayLength": 25,
				"drawCallback": function ( settings ) {
					var api = this.api();
					var rows = api.rows( {page:'current'} ).nodes();
					var last=null;
		 
					api.column(groupNum, {page:'current'} ).data().each( function ( group, i ) {
						if ( last !== group ) {
							$(rows).eq( i ).before(
								'<tr class="group"><td colspan="8">'+group+'</td></tr>'
							);
		 
							last = group;
						}
					} );
				}
			} );
		 
			// Order by the grouping
			$('#example-row-grouping-2 tbody, #top-table tbody').on( 'click', 'tr.group', function () {
				var currentOrder = table.order()[0];
				if ( currentOrder[0] === groupNum && currentOrder[1] === 'asc' ) {
					table.order( [ groupNum, 'desc' ] ).draw();
				}
				else {
					table.order( [ groupNum, 'asc' ] ).draw();
				}
				return false;
			} );
			
		</script>
	</th:block>
	
	<!-- 사용자 정의 자바스크립트 라이브러리 -->
	<th:block layout:fragment="customScriptLib">
		<script src="assets/plugin/datatables/media/js/jquery.dataTables.min.js"></script>
		<script src="assets/plugin/datatables/media/js/dataTables.bootstrap.min.js"></script>
		<script src="assets/plugin/datatables/extensions/Responsive/js/dataTables.responsive.min.js"></script>
		<script src="assets/plugin/datatables/extensions/Responsive/js/responsive.bootstrap.min.js"></script>
		<script src="assets/scripts/datatables.demo.min.js"></script>
	
	</th:block>
</html>