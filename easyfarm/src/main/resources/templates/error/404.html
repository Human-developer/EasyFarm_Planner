<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">

	<th:block layout:fragment="customTitle">
		<title>월간 계획 간편보기</title>
	</th:block>
	
	<th:block layout:fragment="pageTitle">
		월간 계획 간편보기
	</th:block>
	
	<th:block layout:fragment="customCssLib">
	</th:block>
	
	<th:block layout:fragment="customCss">
	<style type="text/css">
		.game{
			width 	: 600px;
			height	: 220px;
			border	: 1px solid;
			margin  : auto;
			text-align: center;
			background-color: rgb(241,241,241);
		}
		.errorHead{
			font-size: 50px;
		}
		.errorPage{
			text-align: center;
		}
		.text{
			text-decoration: overline;
			position: relative;
			bottom: -150px;
		}
		#dino{
			width 	: 50px;
			height	: 50px;
			/* background-image: url("/assets/images/dino2.png"); */
			background-size : 50px;
			position: relative;
			top 	: 140px;
		}
		.jump{
			animation: jump 0.5s linear;
		}
	@keyframes jump {
		0% {
			top: 150px;
		}
		30% {
			top: 130px;
		}
		50% {
			top: 80px;
		}
		80% {
			top: 130px;
		}
		100% {
			top: 150px;
		}
	}	
		.cactus{
			width 	: 20px;
			height	: 40px;
			position: relative;
			top	: 110px;
			left: 580px;
			background-image: url("/assets/images/cactus.png");
			background-size: 20px 40px;
			
			animation: block 1s infinite linear;
		}
		@keyframes block{
			0% {
				left: 580px;
			}
		
			100% {
				left: 0px;
			}
		}
		
		.dino1{
			background-image: url("/assets/images/dino2.png");
		}
		.dino2{
			background-image: url("/assets/images/dino1.png");
		}
		.dieno{
			background-image: url("/assets/images/dieno.png");
		}
	</style>
	</th:block>
	

	
	<th:block layout:fragment="customContents">
	
	<div class="errorPage"> <span class="errorHead"> 404 ERROR! </span><br /> 
		<p th:text="${'path: ' + path}"></p> 
		<p th:text="${'status: ' + status}"></p> 
		<p th:text="${'timestamp: ' + timestamp}"></p> 
		<p th:text="${'error: ' + error}"></p> 
		<p th:text="${'errors: ' + errors}"></p> 
		<p th:text="${'exception: ' + exception}"></p> 
		<p th:text="${'message: ' + message}"></p> 
		<p th:text="${'trace: ' + trace}"></p> 
	</div>
		
		<div class="row small-spacing">
			<div class="col-xs-12">
				
				<div class="game"> <div class ="score">점수 : 0</div> <h3 class="text">:: 스페이스바를 눌러 시작 ::</h3>
					<div id="dino" ></div>
					<div id="cactus"></div>
				</div>
			</div>
		</div>
	</th:block>
	
	
	
	
	
	
	
	
	<th:block layout:fragment="customScriptLib">
		<!-- FullCalendar -->
		<script th:src="@{/assets/plugin/moment/moment.js}"></script>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
	</th:block>
	
	<th:block layout:fragment="customJavaScript">
		<script>
			var game = $('.game');
			var dino = $('#dino');
			var cactus = $('#cactus');
			var num = 0;
			var scoreNum = 0;
			
			var tf = function(){
				cactus.addClass('cactus');
				num++;
				if(num % 2 == 0){
					dino.removeClass('dino2').removeClass('dieno').addClass('dino1');	
				}
				else{
					dino.removeClass('dino1').removeClass('dieno').addClass('dino2');
				}
				
			};
			var setI = null;
			document.addEventListener("keydown",function(event){
				//esc 정지
				if(event.keyCode == 27){
					clearInterval(setI);
					cactus.removeClass();
				}
				
				//스페이스바 점프
				if(event.keyCode == 32){
					//시작시 점수집계
					var score = setInterval(function(){
						$('.score').text("점수 : " + scoreNum);
						scoreNum++;
					},1000);
					//공룡 모션
					if(setI == null){
						setI = setInterval(tf,200);
						$('.text').css('display', 'none');
						$('.errorPage').css('display', 'none');
					}
					else{
						if(dino.hasClass('jump')==false){							
							dino.addClass('jump');
							//점프
							setTimeout(function(){
								dino.removeClass('jump');	
							},500); 
						}
					}
				}
			})
			
			let isAlive = setInterval(function(){
				let dinoTop = parseInt(dino.css("top"));
				let cactusLeft = parseInt(cactus.css("left"));
				
				if(cactusLeft < 40 && cactusLeft > 0 && dinoTop >= 140)
				{
					dino.removeClass('dino1').removeClass('dino2').addClass('dieno')
					cactus.removeClass('cactus');
					if(dino.hasClass('dieno')==true){
						clearInterval(setI);
						cactus.removeClass();
						Swal.fire({
							  title: '공룡이 죽고 말았어',
							  text: '최종점수 : '+scoreNum + '점',
							  imageUrl: '/assets/images/dieno.png',
							  imageWidth: 400,
							  imageHeight: 200,
							  imageAlt: 'Custom image',
							  confirmButtonText: '다시하기',
							}).then((result) => {
								location.reload();
							})
					}
				}
			}, 10);
			
		</script>
	
	</th:block>
	
</html>