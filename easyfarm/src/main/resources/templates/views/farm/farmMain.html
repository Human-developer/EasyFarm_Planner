<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">

	<th:block layout:fragment="customTitle">
		<title>농가 메인</title>
	</th:block>
	
	<th:block layout:fragment="pageTitle">
		<a th:href="@{/farm}">농가관리</a>
	</th:block>
	
	<!-- 사용자 정의 css 라이브러리 -->
	<th:block layout:fragment="customCssLib">
		<link rel="stylesheet" th:href="@{/assets/sys/sysStyle.css}">
	</th:block>
	
	<!-- 사용자 정의 css -->
	<th:block layout:fragment="customCss">
		<style type="text/css">
			.modal {
			        text-align: center;
			}
			
			.modal:before {
			                display: inline-block;
			                vertical-align: middle;
			                content: " ";
			                height: 100%;
			}
			
			 
			.modal-dialog {
			        display: inline-block;
			        text-align: left;
			        vertical-align: middle;
			}
		</style>
	</th:block>
	
	<th:block layout:fragment="customJavaScript">
		<script type="text/javascript">
			var lang_kor = {
			        "decimal" : "",
			        "emptyTable" : "내 농가가 없습니다",
			        "info" : "_START_ - _END_ (총 _TOTAL_ 명)",
			        "infoEmpty" : "0명",
			        "infoFiltered" : "(전체 _MAX_ 농가 중 검색결과)",
			        "infoPostFix" : "",
			        "thousands" : ",",
			        "lengthMenu" : "_MENU_ 개씩 보기",
			        "loadingRecords" : "로딩중...",
			        "processing" : "처리중...",
			        "search" : "검색 : ",
			        "zeroRecords" : "검색된 농가가 없습니다.",
			        "paginate" : {
			            "first" : "첫 페이지",
			            "last" : "마지막 페이지",
			            "next" : "다음",
			            "previous" : "이전"
			        },
			        "aria" : {
			            "sortAscending" : " :  오름차순 정렬",
			            "sortDescending" : " :  내림차순 정렬"
			        }
			}
			
			        
			$('.dataFarmTable').sysDataTable(lang_kor,[0,1],3);
			
			
		</script>
	</th:block>

	<th:block layout:fragment="customContents">
		<div class ="container-fluid">
			<div class ="row"> 
				<div class ="box-content">
					<h3>내농가</h3>
					<hr>
					
					<table class="table table-striped table-bordered display dataTable dataFarmTable" style ="width: 100%;">
						<thead>
							<tr>
								<th class ="hidden" th:text = "${'농가코드'}"/>
								<th class ="hidden" th:text = "${'권한'}"/>
								<th th:text ="${'농가명'}"/>
								<th th:text ="${'대표자 아이디'}"/>
								<th th:text ="${'토지 면적'}"/>
								<th th:text ="${'주소'}"/>
								<th th:text ="${'농가 생성일'}"/>
								<th th:text ="${'농가 공개유무'}"/>
								<th th:text ="${''}"/>
							</tr>
						</thead>
						
						<tbody>
							<tr th:each="farm : ${myFarmList}" class ="farmList">
								<td class ="hidden" th:text = "${farm.farmCode}"/>
								<td class ="hidden" th:text = "${farm.farmMemberLevel}"/>
								<td th:text = "${farm.farmName}"/>
								<td th:text = "${farm.ceoId}"/>
								<td th:text = "${farm.farmArea}"/>
								<td th:text = "${farm.farmAddress}"/>
								<td th:text = "${farm.farmRegDate}"/>
								<td th:text = "${farm.farmPublicStatus}"/>
								<td>
									<div class="btn-group">
										<button type="button" class="btn btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-cog"></span></button> 
										<ul class="dropdown-menu">
											<li><a th:href="@{/farm/detailFarm(farmCode=${farm.farmCode},farmMemberLevel=${farm.farmMemberLevel})}">상세보기</a></li>
											<li><a th:href="@{/projectListByFarmCode(farmCode=${farm.farmCode})}">프로젝트</a></li>
											<li><a th:href="@{/farm/getJoinFarm(farmCode=${farm.farmCode})}">가입신청 목록</a></li>
											<li><a th:href="@{/farm/getLeaverFarm(farmCode=${farm.farmCode})}">탈퇴신청 목록</a></li>
											<li><a th:href="@{/farm/modifyFarm(farmCode=${farm.farmCode},farmMemberLevel=${farm.farmMemberLevel})}">수정</a></li>
										</ul>
									</div>
								</td>
								
							</tr>
							
						</tbody>
					</table>
				</div>
				
				<div class ="box-content">
					<h3>내 소속 농가</h3>
					<hr>
					
					<table class="table table-striped table-bordered display dataTable dataFarmTable" style ="width: 100%;">
						<thead>
							<tr>
								<th class ="hidden" th:text = "${'농가코드'}"/>
								<th class ="hidden" th:text = "${'권한'}"/>
								<th th:text ="${'농가명'}"/>
								<th th:text ="${'대표자 아이디'}"/>
								<th th:text ="${'토지 면적'}"/>
								<th th:text ="${'주소'}"/>
								<th th:text ="${'농가 생성일'}"/>
								<th th:text ="${''}"/>
							</tr>
						</thead>
						
						<tbody>
							<tr th:each="farm : ${belongFarmList}" class ="farmList">
								<td class ="hidden" id ="farmCode" th:text = "${farm.farmCode}"/>
								<td class ="hidden" id ="farmMemberLevel" th:text = "${farm.farmMemberLevel}"/>
								<td th:text = "${farm.farmName}"/>
								<td th:text = "${farm.ceoId}"/>
								<td th:text = "${farm.farmArea}"/>
								<td th:text = "${farm.farmAddress}"/>
								<td th:text = "${farm.farmRegDate}"/>
								<td>
									<div class="btn-group">
										<button type="button" class="btn btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-cog"></span></button> 
										<ul class="dropdown-menu">
											<li><a th:href="@{/farm/detailFarm(farmCode=${farm.farmCode},farmMemberLevel=${farm.farmMemberLevel})}">상세보기</a></li>
											<li><a th:href="@{/projectListByFarmCode(farmCode=${farm.farmCode})}">프로젝트</a></li>
											<li th:if ="${farm.farmMemberLevel == 'farm_level_1' OR farm.farmMemberLevel == 'farm_level_2' }"><a th:href="@{/farm/modifyFarm(farmCode=${farm.farmCode},farmMemberLevel=${farm.farmMemberLevel})}">수정</a></li>
											<li th:if ="${farm.farmMemberLevel == 'farm_level_1' OR farm.farmMemberLevel == 'farm_level_2' }"><a th:href="@{/farm/getJoinFarm(farmCode=${farm.farmCode})}">가입신청 목록</a></li>
											<li th:if ="${farm.farmMemberLevel == 'farm_level_1' OR farm.farmMemberLevel == 'farm_level_2' }"><a th:href="@{/farm/getLeaverFarm(farmCode=${farm.farmCode})}">탈퇴신청 목록</a></li>
											<li><a th:href="@{#}" class ="farmCancelBtn" data-toggle="modal" data-target="#farmCancelModal">탈퇴</a></li>
										</ul>
									</div>
								</td>
							</tr>
							
						</tbody>
					</table>	
				</div>
			</div>
		</div>
		

	</th:block>
	
	
	<!-- customModals start -->
	<th:block layout:fragment="customModals">
		<div class="modal fade" id="farmCancelModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title t-center" id="myModalLabel">농가 탈퇴 신청</h4>
					</div>
					<div class="modal-body">
						<div class ="row">
							<div class ="col-xs-12">
								<div class ="col-xs-12 margin-bottom-15" style ="padding: 0px;">
									<strong class ="col-xs-3 col-xs-offset-2">농가 이름 : </strong>
									<div id="modalFarmName"></div>
								</div>
								<div class ="col-xs-12 margin-bottom-15" style ="padding: 0px;">
									<strong class ="col-xs-3 col-xs-offset-2">대표 아이디 : </strong>
									<div id="modalCeoId"></div>
								</div>
								<div class ="col-xs-12 margin-bottom-15" style ="padding: 0px;">
									<strong class ="col-xs-3 col-xs-offset-2">농가 주소 : </strong>
									<div id="modalFarmAddress"></div>
								</div>
								<div class ="col-xs-12 margin-bottom-15" style ="padding: 0px;">
									<strong class ="col-xs-3 col-xs-offset-2">토지면적 : </strong>
									<div id="modalFarmArea"></div>
								</div>
							</div>	
							<div class ="col-xs-12">
								<h3 class ="t-center">탈퇴사유</h3>
								<textarea id = "cancelRequestReason" style ="resize: none; margin-bottom: 15px"class ="form-control" cols="10"></textarea>
							</div>
						</div>
						
					</div>
					<div class="modal-footer t-center">
						<button type="button" class="btn btn-default btn-sm waves-effect waves-light" data-dismiss="modal">취소</button>
						<button type="button" id ="addCancelMember" class="btn btn-primary btn-sm waves-effect waves-light" data-dismiss="modal">탈퇴 신청</button>
					</div>
				</div>
			</div>
		</div>
	</th:block>
	<!-- customModals end -->
	
	
	<!-- 사용자 정의 자바스크립트 라이브러리 -->
	<th:block layout:fragment="customScriptLib">
		<script src="/assets/plugin/datatables/media/js/jquery.dataTables.min.js"></script>
		<script src="/assets/plugin/datatables/media/js/dataTables.bootstrap.min.js"></script>
		<script src="/assets/plugin/datatables/extensions/Responsive/js/dataTables.responsive.min.js"></script>
		<script src="/assets/plugin/datatables/extensions/Responsive/js/responsive.bootstrap.min.js"></script>
		<script src="/assets/scripts/datatables.demo.min.js"></script>
		
		<script th:src = @{/assets/sys/myDataTable.js}></script>
	</th:block>

</html>