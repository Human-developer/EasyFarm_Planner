<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">
	  
	<!-- 화면 title 설정 -->
	<th:block layout:fragment="customTitle">
		<title>농가수정</title>
	</th:block>
	
	<!-- 위에 네비 메뉴에 표시되는 경로 타이틀 -->
	<th:block layout:fragment="pageTitle">
		<a th:href="@{/farm}">농가관리</a>>농가수정
	</th:block>
	
	<!-- 사용자 정의 css 라이브러리 -->
	<th:block layout:fragment="customCssLib">
		<link rel="stylesheet" th:href="@{/assets/plugin/touchspin/jquery.bootstrap-touchspin.min.css}">
	</th:block>
	
	<!-- 사용자 정의 css -->
	<th:block layout:fragment="customCss"></th:block>
	
	
	<!-- 컨텐츠 작성은 여기서  ↓ ↓ ↓ -->
	<th:block layout:fragment="customContents">
		<div class ="container-fluid">
			<div class ="row">
				<div class ="col-xs-offset-2 col-xs-8">
					<div class ="box-content">
						<h3>농가 수정</h3>
						<hr>
						<form th:action="@{/farm/modifyFarm}" method="post">
						
							<input type="text" class ="form-control hidden" name ="farmCode" th:value="${farm.farmCode}" readonly="readonly">
							<input type="text" class ="form-control hidden" name ="farmMemberLevel" th:value="${farm.farmMemberLevel}" readonly="readonly">
							<table class ="table">
								<tbody>
									<tr>
										<th>농가명</th>
										<td><input type="text" class ="form-control" name ="farmName" th:value="${farm.farmName}" readonly="readonly"></td>
									</tr>
									<tr>
										<th>대표아이디</th>
										<td><input type="text" class ="form-control" name ="ceoId" th:value="${farm.ceoId}" readonly="readonly"></td>
									</tr>
									<tr>
										<th>토지면적</th>
										<td colspan="1"><input type="text" class ="form-control" id ="farmArea" name ="farmArea" th:value="${farm.farmArea}"></td>
									</tr>
									<tr>
										<th>주소</th>
										<td><input type="text" class ="form-control" name ="farmAddress" th:value="${farm.farmAddress}" readonly="readonly"></td>
										<td><button type="button" id="addressBtn" class ="btn btn-info btn-rounded waves-effect waves-light">주소선택</button></td>
									</tr>
									<tr>
										<th>공개유무</th>
										<td>
											<input type="radio" th:value="Y" th:checked="${'Y'.equals(farm.farmPublicStatus)}" name ="farmPublicStatus"> 공개
											<input type="radio" th:value="N" th:checked="${'N'.equals(farm.farmPublicStatus)}" name ="farmPublicStatus"> 비공개
										</td>
									</tr>
								</tbody>
							</table>
							<div class ="col-xs-12 t-center">
								<button type="submit" id ="modifyButton" class ="btn btn-success">수정</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</th:block>
	
	
	<!-- 사용자 정의 자바스크립트 라이브러리 -->
	<th:block layout:fragment="customScriptLib">
		<script th:src="@{/assets/plugin/touchspin/jquery.bootstrap-touchspin.min.js}"></script>
		<script src="http://dmaps.daum.net/map_js_init/postcode.v2.js"></script>
	</th:block>
	
	<!-- 사용자 정의 자바스크립트 -->
	<th:block layout:fragment="customJavaScript">
		<script type="text/javascript">
			$("#farmArea").TouchSpin({
		         verticalbuttons: true,
		         min : 0,
		         max : 10000000000,
		         postfix : '평'
		      });
			$("#farmArea").parent().find('.input-group-btn-vertical').remove();
			
			 $('#addressBtn').click(function(){
		    	  
		    	  new daum.Postcode({
			            oncomplete: function(data) {
			                // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.
			 
			                // 도로명 주소의 노출 규칙에 따라 주소를 조합한다.
			                // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
			                var fullRoadAddr = data.roadAddress; // 도로명 주소 변수
			                var extraRoadAddr = ''; // 도로명 조합형 주소 변수
			 
			                // 법정동명이 있을 경우 추가한다. (법정리는 제외)
			                // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
			                if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
			                    extraRoadAddr += data.bname;
			                }
			                // 건물명이 있고, 공동주택일 경우 추가한다.
			                if(data.buildingName !== '' && data.apartment === 'Y'){
			                   extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
			                }
			                // 도로명, 지번 조합형 주소가 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
			                if(extraRoadAddr !== ''){
			                    extraRoadAddr = ' (' + extraRoadAddr + ')';
			                }
			                // 도로명, 지번 주소의 유무에 따라 해당 조합형 주소를 추가한다.
			                if(fullRoadAddr !== ''){
			                    fullRoadAddr += extraRoadAddr;
			                }
			 
			                // 우편번호와 주소 정보를 해당 필드에 넣는다.
			               
			                addr.val(fullRoadAddr);

			            }
			        }).open();
		      })
		</script>
	</th:block>

</html>