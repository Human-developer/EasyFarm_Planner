<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">
	  
	<!-- 화면 title 설정 -->
	<th:block layout:fragment="customTitle">
		<title>신고목록 조회</title>
	</th:block>
	
	<!-- 위에 네비 메뉴에 표시되는 경로 타이틀 -->
	<th:block layout:fragment="pageTitle">
		신고목록 조회
	</th:block>
	 <!-- 사용자 정의 css 라이브러리 -->
	<th:block layout:fragment="customCssLib">
		<link rel="stylesheet" th:href="@{/assets/sys/sysStyle.css}">
	</th:block>
	
	<th:block layout:fragment="customCss">
		<style type="text/css">
		
			.modal-content{
				        display: none;
				        width: 500px;
				        height: 200px;
				        position: absolute;
				        top:50%;
				        left: 50%;
				        margin: -100px 0 0 -250px;
				        background:white;
				        z-index: 2;
				    }
		</style>
	</th:block>
	<!-- 컨텐츠 작성은 여기서  ↓ ↓ ↓ -->
	<th:block layout:fragment="customContents">
	
	 
			
				
			<div class="box-content">
					<table id="reportReasonTable">
						<thead>
							<tr>
								
								<th>신고사유</th>
								<th>대상 아이디</th>						
								<th>내용</th>			
								<th>등록일</th>
								<th>승인/반려 상태</th>
								<th>승인/반려 사유</th>
								<th>설정</th>
								
								
							</tr>
						</thead>
						<tbody>
							<tr th:each="r : ${reportList}">													
								<td th:text="${r.reportReason}"></td>				
								<td th:text="${r.reportedMemberId}"></td>													
								<td ><a th:text="내용" th:data-val="${r.reportDetailReason}" href="#" class="contents"></a></td>			
								<td th:text="${r.reportDate}"></td>													
								<td th:text="${r.reportApproval}"></td>		
								<td><a th:text="반려사유" th:data-val="${r.reportApprovalReason}" href="#" class="contents2"></a></td>	
								<td th:if="${r.reportApproval == '진행중'}">
									<div class="btn-group" >
										<button type="button" class="btn btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ><span class="fa fa-balance-scale" ></span></button> 
										<ul class="dropdown-menu">
										  	<li ><a th:href ="@{/member/modifyReport(reportHistoryCode=${r.reportHistoryCode})}">수정</a></li>
										  	<li ><a class="remove" th:data-val="${r.reportHistoryCode}" href="#">취소</a></li>
										  	
										</ul>
									</div>
								</td>								
								<td th:if="${r.reportApproval != null and r.reportApproval != '진행중'}">
									<div class="btn-group" >
										<button type="button" class="btn btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ><span class="fa fa-balance-scale" ></span></button> 
										<ul class="dropdown-menu">
										  	<li ><a class="remove" th:data-val="${r.reportHistoryCode}" href="#">삭제</a></li>
										</ul>
									</div>
								</td>								
					
							
							</tr>
						
							
						</tbody>		
	
					</table>
				<div class="modal-content"  style = "display: none">
					<div class="modal-header">
						<button type="button" class="close" ><span class="close" style="color: black;">X</span></button>
						<h4 class="modal-title"></h4>
					</div>
					<div class="modal-body">
						<p class="text" style="color: black;"></p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn  close  " ><span style="color: black;">Close</span> </button>
					</div>
				</div>
			</div>
	</th:block>
	
	
	<th:block layout:fragment="customScriptLib">
	
		<div th:replace="fragments/dataTable :: dataTable" th:remove="tag"></div>
			
	</th:block>
	
		<th:block layout:fragment="customJavaScript">
		<script>
			var lang_kor = {
			        "decimal" : "",
			        "emptyTable" : "신고목록이 없습니다",
			        "info" : "_START_ - _END_ (총 _TOTAL_ 명)",
			        "infoEmpty" : "0명",
			        "infoFiltered" : "(전체 _MAX_ 신고목록 중 검색결과)",
			        "infoPostFix" : "",
			        "thousands" : ",",
			        "lengthMenu" : "_MENU_ 개씩 보기",
			        "loadingRecords" : "로딩중...",
			        "processing" : "처리중...",
			        "search" : "검색 : ",
			        "zeroRecords" : "검색된 목록이 없습니다.",
			        "paginate" : {
			            "first" : "첫 페이지",
			            "last" : "마지막 페이지",
			            "next" : "다음",
			            "previous" : "이전"
			        },
			        "aria" : {
			            "sortAscending" : " :  오름차순 정렬",
			            "sortDescending" : " :  내림차순 정렬"
			        }
			}
			
			$('#reportReasonTable').sysDataTable(lang_kor);
			
			
			 $('.contents').click(function(){
				  $('.text').text("");
		    	  var contents = $(this).attr("data-val");
				  $('.modal-content').attr('style','display: block');
				  $('.text').text(contents);
				  $('.modal-title').text("신고내용");
					   
			 })
			 
			 	
			 $('.close').click(function(){
			  		  
			 	 $('.modal-content').attr('style','display: none');
			 })
			 
			 $('.contents2').click(function(){
				  $('.text').text("");
		    	  var contents = $(this).attr("data-val");
				  $('.modal-content').attr('style','display: block');
				  $('.text').text(contents);
				  $('.modal-title').text("반려내용");
			 })
			 
			 	
			 $('.close').click(function(){
			  		  
			 	 $('.modal-content').attr('style','display: none');
			 })
			 
			 $('.remove').click(function(){
		    	  var removeCode = $(this).attr("data-val");
		   
					swal({   
						title: "정말 삭제하시겠습니까?",   
						text: "삭제시 복구불가",   
						type: "warning",   
						showCancelButton: true,   
						confirmButtonColor: "#DD6B55",   
						confirmButtonText: "삭제!", 
						cancelButtonText: "취소!", 
						closeOnConfirm: false,
						closeOnCancel: true,
						confirmButtonColor: '#f60e0e',
					},function(isConfirm){   
						if (isConfirm) {     
							location.href = "/member/removeReport?reportHistoryCode="+removeCode;
						}
					});
				})
				
		
			 
			
		
		</script>
	</th:block>
	

</html>